import os
import time
import getpass
import pathlib

pdfTotal = 0
imageFileTotal = 0
MsOfficeTotal = 0
#exeTotal = 0
otherTotal = 0

pdf_path = []
image_path = []
MsOffice_path = []
#exe_path = []
other_path = []

pdf = [".pdf"]
image = [".bmp", ".jpeg", ".gif", ".tiff", ".png", ".pcx", ".rle", ".dib", ".jpg"]
o365 = [".docx", ".accdb", ".bks", ".crtx", ".csv", ".cub", ".cvr", ".doc", ".dochtml", ".docm", ".docmhtml", ".docxml", ".dot", ".dothtml", ".dotm", ".dotx", ".dqy", ".eftx", ".exd", ".ffa",
".ffl", ".ffo", ".ffx", ".gcsx", ".glox", ".gly", ".gqsx", ".gra", ".mdb", ".mgc", ".mml", ".mmw", ".obd", ".odc", ".officeui", ".olk", ".one", ".onepkg", ".onetoc2", ".otm", ".pip", ".potx",
".ppt", ".pptx", ".pwi", ".qat", ".rtf", ".shs", ".thmx", ".tsv", ".txt", ".wbk", ".xar", ".xl", ".xlb", ".xlc", ".xld", ".xlk", ".xlm", ".xls", ".xlsb", ".xlshtml", ".xlsm", ".xlsx", ".xlt",
".xlthtml", ".xltm", ".xltx", ".xlv", ".xlw", ".edi", ".fm3", ".gpr", ".graphml", ".iif", ".info", ".ini", ".iqy", ".jrtf", ".lst", ".md", ".mdi", ".ods", ".opal", ".opax", ".ops", ".pde",
".pder", ".pptm", ".wll", ".xla", ".xlam", ".xll"]

#exe = [".exe"]

#dirName = 'C:/Users/DUSCHLG/Desktop'
dirName = 'C:/Users/DUSCHLG/Desktop/Projekte'
#dirName = 'C:/Users/DUSCHLG/Desktop/Projekte/Bachelorarbeit/Malware Entwicklung/testfiles'

dir_path = os.path.dirname(os.path.realpath(__file__))

username = getpass.getuser()
drive = pathlib.Path.home().drive
print(username)
print(drive)


def getFiles(dirName):
    listOfFile = os.listdir(dirName)
    completeFileList = list()
    for file in listOfFile:
        completePath = os.path.join(dirName, file)
        if os.path.isdir(completePath):
            completeFileList = completeFileList + getFiles(completePath)
        else:
            completeFileList.append(completePath)

    return completeFileList

listOfFiles = getFiles(dirName)
fileTotal = len(listOfFiles)

for i in range(1, fileTotal):
        file = listOfFiles[i]
        if any (x in file for x in pdf):
                pdfTotal  += 1
                pdf_path.append(file)
        elif any (x in file for x in image):
                imageFileTotal += 1
                image_path.append(file)
        elif any (x in file for x in o365):
                MsOfficeTotal += 1
                MsOffice_path.append(file)
        else:
                otherTotal = otherTotal + 1
                other_path.append(file)
    

for i in range(1, pdfTotal):
    file = pdf_path[i]
    print(file)



print('Total files:',fileTotal)
print('PDF Dateien:',pdfTotal )
print('Fotodateien:',imageFileTotal)
print('MS Office Dateien:',MsOfficeTotal)
print('andere Dateien:',otherTotal)
                                                 

